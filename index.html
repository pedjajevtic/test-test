<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">

    <style>
        body {
            padding: 0;
            margin: 0 10%;
            background: linear-gradient(25deg, rgba(82, 174, 48, 1) 0%, rgba(255, 255, 255, 1) 65%);
            background-attachment: fixed;
            font-family: 'Source-Sans-Pro', sans-serif;
        }

        p {
            font-weight: bold;
        }

        .img-wrapper {
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        .img-wrapper img {
            width: 100%;
            max-width: 800px;
            border-radius: 25px;
        }

        .app-links {
            display: flex;
            align-items: center;
            margin-top: 20px;
            gap: 20px;
            flex-direction: column;
        }

        .header-wrapper {
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            margin: 20px 0px 50px 0px; 
        }

        .otp-promo-img {
            width: 30%;
        }

        .otp-promo-text {
            margin-left: 7px;
            padding-left: 7px;
            border-left: 3px solid #2A7F00;
            color: #2A7F00;
            font-weight: bold;
            font-size: 20px;
        }

        .app-link {
            width: 45%;
            padding: 14px 45px;
            margin: 20px 0px;
            background-color: #52AE30;
            border-radius: 25px;
            text-align: center;
            color: #FFFFFF;
            text-decoration: none !important;
            font-weight: 600;
            transition: all .5s;
        }

        .app-link:hover {
            background-color: #2A7F00;
        }
    </style>
</head>

<body>
<!-- izmena landing stranice -->
<div id="landingContent" style="display:none;">
  <p>Neki tekst.......</p>
  <div class="app-links">
    <a id="openAppBtn" target="_blank" class="app-link">Otvori aplikaciju</a>
  </div>
</div>
    
<!-- izmena fallback stranice -->
<div id="fallbackContent" style="display:none; text-align:center;">
  <p>Niste instalirali aplikaciju?</p>
  <a href="https://www.otpbanka.rs/mobileTarget" class="app-link">Nastavi na web verziju</a>
</div>

<!-- IZMENA DEEPLINKA -->
<a id="hiddenDeeplink" 
   href="https://ebank.otpbanka.rs/mobileTarget/?data=ewogICJUYXJnZXQiOiJEQi5tS2VzIgp9&utm_source=Facebook&utm_medium=Traffic&utm_campaign=Deeplink_mCash_Online_sales_202508&utm_content=120232029472500056%2F%2FOS_FB_LG_customer-list_kes-kredit_092025-01163&utm_term=120232029472510056%2F%2FInstagram_Feed%2F%2F7.5%25EKS_Mbank&utm_id=&crmc=4c3dea17-5372-733a-b283-685cf056bdc3&crm_campaign=CCC_IND_ONLINE_SALES_MBANK_DEEPLINK_RTDE_SLS_062025_P&fbclid=PAb21jcAMswAdleHRuA2FlbQEwAGFkaWQBqyZlQyT9GAGn4GZe1fiqsLyzQofJBEKJ8lgiNETSdLpd_O9V63kGW54yr_clXnwGQ_04KtE_aem_mEnwGhWOMGB5752cRx_zlg">
</a>

<script>
  const btn = document.getElementById("openAppBtn");
  const deeplink = document.getElementById("hiddenDeeplink");
  const landing = document.getElementById("landingContent");
  const fallback = document.getElementById("fallbackContent");

  function isInAppBrowser() {
    const ua = navigator.userAgent || "";
    return ua.includes("FBAN") || ua.includes("FBAV") || ua.includes("FB_IAB") || ua.includes("Instagram");
  }

  function isAndroid() {
    return /Android/i.test(navigator.userAgent);
  }

  function isIOS() {
    return /iPhone|iPad|iPod/i.test(navigator.userAgent);
  }

  function openDeeplinkWithFallback() {
    let fallbackTimer = setTimeout(() => {
      landing.style.display = "none";
      fallback.style.display = "block";
    }, 2000);

    document.addEventListener("visibilitychange", () => {
      if (document.hidden) {
        clearTimeout(fallbackTimer);
      }
    });

    deeplink.click();
  }

  if (isIOS()) {
    if (isInAppBrowser()) {
      landing.style.display = "block";
      btn.addEventListener("click", openDeeplinkWithFallback);
    } else {
      openDeeplinkWithFallback();
    }  
  } else { 
    openDeeplinkWithFallback();
  }

  /*
  if (isAndroid()) {
    openDeeplinkWithFallback();
  } else if (isIOS()) {
    if (isInAppBrowser()) {
      landing.style.display = "block";
      btn.addEventListener("click", openDeeplinkWithFallback);
    } else {
      openDeeplinkWithFallback();
    }
  } else {
    landing.style.display = "block";
    btn.style.display = "none"; 
    fallback.style.display = "block";
  }
  */ 
</script>
</body>
</html>

